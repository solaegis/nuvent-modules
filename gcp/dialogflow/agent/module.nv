#------------------------------------------------------------------------------
# gcp/dialogflow/agent/module.nv
# yaml-language-server: $schema=https://raw.githubusercontent.com/solaegis/nuvent/refs/heads/main/tools/vscode-extension/schemas/nuvent-manifest.schema.json?token=GHSAT0AAAAAADJBKTZJYHQDWBGJPIP6TMBS2KUJZ3A
#------------------------------------------------------------------------------

variables:
  default_language_code:
    type: string
    description: "The default language of the agent as a language tag. [See Language Support](https://cloud.google.com/dialogflow/docs/reference/language) for a list of the currently supported language codes. This field cannot be updated after creation."
  display_name:
    type: string
    description: "The name of this agent."
  time_zone:
    type: string
    description: "The time zone of this agent from the [time zone database](https://www.iana.org/time-zones), e.g., America/New_York, Europe/Paris."
  api_version:
    type: string
    description: "API version displayed in Dialogflow console. If not specified, V2 API is assumed. Clients are free to query different service endpoints for different API versions. However, bots connectors and webhook calls will follow the specified API version. * API_VERSION_V1: Legacy V1 API. * API_VERSION_V2: V2 API. * API_VERSION_V2_BETA_1: V2beta1 API. Possible values: [\"API_VERSION_V1\", \"API_VERSION_V2\", \"API_VERSION_V2_BETA_1\"]"
    default: null
  avatar_uri:
    type: string
    description: "The URI of the agent's avatar, which are used throughout the Dialogflow console. When an image URL is entered into this field, the Dialogflow will save the image in the backend. The address of the backend image returned from the API will be shown in the [avatarUriBackend] field."
    default: null
  classification_threshold:
    type: number
    description: "To filter out false positive results and still get variety in matched natural language inputs for your agent, you can tune the machine learning classification threshold. If the returned score value is less than the threshold value, then a fallback intent will be triggered or, if there are no fallback intents defined, no intent will be triggered. The score values range from 0.0 (completely uncertain) to 1.0 (completely certain). If set to 0.0, the default of 0.3 is used."
    default: null
  description:
    type: string
    description: "The description of this agent. The maximum length is 500 characters. If exceeded, the request is rejected."
    default: null
  enable_logging:
    type: boolean
    description: "Determines whether this agent should log conversation queries."
    default: null
  id:
    type: string
    description: "Optional property for Agent"
    default: null
  match_mode:
    type: string
    description: "Determines how intents are detected from user queries. * MATCH_MODE_HYBRID: Best for agents with a small number of examples in intents and/or wide use of templates syntax and composite entities. * MATCH_MODE_ML_ONLY: Can be used for agents with a large number of examples in intents, especially the ones using @sys.any or very large developer entities. Possible values: [\"MATCH_MODE_HYBRID\", \"MATCH_MODE_ML_ONLY\"]"
    default: null
  project:
    type: string
    description: "Optional property for Agent"
    default: null
  supported_language_codes:
    type: list
    description: "The list of all languages supported by this agent (except for the defaultLanguageCode)."
    default: null
  tier:
    type: string
    description: "The agent tier. If not specified, TIER_STANDARD is assumed. * TIER_STANDARD: Standard tier. * TIER_ENTERPRISE: Enterprise tier (Essentials). * TIER_ENTERPRISE_PLUS: Enterprise tier (Plus). NOTE: Due to consistency issues, the provider will not read this field from the API. Drift is possible between the Terraform state and Dialogflow if the agent tier is changed outside of Terraform. Possible values: [\"TIER_STANDARD\", \"TIER_ENTERPRISE\", \"TIER_ENTERPRISE_PLUS\"]"
    default: null
  timeouts:
    type: list
    description: "Nested block: timeouts"
    default: []

resources:
  main:
    type: gcp:dialogflow:Agent
    properties:
      default_language_code: ${var.default_language_code}
      display_name: ${var.display_name}
      time_zone: ${var.time_zone}
      api_version: ${var.api_version}
      avatar_uri: ${var.avatar_uri}
      classification_threshold: ${var.classification_threshold}
      description: ${var.description}
      enable_logging: ${var.enable_logging}
      id: ${var.id}
      match_mode: ${var.match_mode}
      project: ${var.project}
      supported_language_codes: ${var.supported_language_codes}
      tier: ${var.tier}
      dynamic:
        timeouts:
          for_each: ${var.timeouts}
          content:
            create: ${each.value.create}
            delete: ${each.value.delete}
            update: ${each.value.update}

outputs:
  api_version:
    description: "API version displayed in Dialogflow console. If not specified, V2 API is assumed. Clients are free to query different service endpoints for different API versions. However, bots connectors and webhook calls will follow the specified API version. * API_VERSION_V1: Legacy V1 API. * API_VERSION_V2: V2 API. * API_VERSION_V2_BETA_1: V2beta1 API. Possible values: [\"API_VERSION_V1\", \"API_VERSION_V2\", \"API_VERSION_V2_BETA_1\"]"
    value: ${resources.main.api_version}
  avatar_uri_backend:
    description: "The URI of the agent's avatar as returned from the API. Output only. To provide an image URL for the agent avatar, the [avatarUri] field can be used."
    value: ${resources.main.avatar_uri_backend}
  id:
    description: "Output: id"
    value: ${resources.main.id}
  match_mode:
    description: "Determines how intents are detected from user queries. * MATCH_MODE_HYBRID: Best for agents with a small number of examples in intents and/or wide use of templates syntax and composite entities. * MATCH_MODE_ML_ONLY: Can be used for agents with a large number of examples in intents, especially the ones using @sys.any or very large developer entities. Possible values: [\"MATCH_MODE_HYBRID\", \"MATCH_MODE_ML_ONLY\"]"
    value: ${resources.main.match_mode}
  project:
    description: "Output: project"
    value: ${resources.main.project}
